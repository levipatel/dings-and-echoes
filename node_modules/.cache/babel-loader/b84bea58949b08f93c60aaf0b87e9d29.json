{"ast":null,"code":"import { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport var createNativeConvolverNodeFactory = function createNativeConvolverNodeFactory(createNativeAudioNode, createNativeConvolverNodeFaker, createNotSupportedError, overwriteAccessors) {\n  return function (nativeContext, options) {\n    var nativeConvolverNode = createNativeAudioNode(nativeContext, function (ntvCntxt) {\n      return ntvCntxt.createConvolver();\n    });\n\n    try {\n      // Bug #166: Opera does not allow yet to set the channelCount to 1.\n      nativeConvolverNode.channelCount = 1;\n    } catch (err) {\n      return createNativeConvolverNodeFaker(nativeContext, options);\n    }\n\n    assignNativeAudioNodeOptions(nativeConvolverNode, options); // The normalize property needs to be set before setting the buffer.\n\n    if (options.disableNormalization === nativeConvolverNode.normalize) {\n      nativeConvolverNode.normalize = !options.disableNormalization;\n    }\n\n    assignNativeAudioNodeOption(nativeConvolverNode, options, 'buffer'); // Bug #113: Edge & Safari allow to set the channelCount to a value larger than 2.\n\n    if (options.channelCount > 2) {\n      throw createNotSupportedError();\n    }\n\n    overwriteAccessors(nativeConvolverNode, 'channelCount', function (get) {\n      return function () {\n        return get.call(nativeConvolverNode);\n      };\n    }, function (set) {\n      return function (value) {\n        if (value > 2) {\n          throw createNotSupportedError();\n        }\n\n        return set.call(nativeConvolverNode, value);\n      };\n    }); // Bug #114: Edge & Safari allow to set the channelCountMode to 'max'.\n\n    if (options.channelCountMode === 'max') {\n      throw createNotSupportedError();\n    }\n\n    overwriteAccessors(nativeConvolverNode, 'channelCountMode', function (get) {\n      return function () {\n        return get.call(nativeConvolverNode);\n      };\n    }, function (set) {\n      return function (value) {\n        if (value === 'max') {\n          throw createNotSupportedError();\n        }\n\n        return set.call(nativeConvolverNode, value);\n      };\n    });\n    return nativeConvolverNode;\n  };\n};","map":{"version":3,"sources":["../../../src/factories/native-convolver-node-factory.ts"],"names":[],"mappings":"AAAA,SAAS,2BAAT,QAA4C,4CAA5C;AACA,SAAS,4BAAT,QAA6C,6CAA7C;AAGA,OAAO,IAAM,gCAAgC,GAAuC,SAAvE,gCAAuE,CAChF,qBADgF,EAEhF,8BAFgF,EAGhF,uBAHgF,EAIhF,kBAJgF,EAKhF;AACA,SAAO,UAAC,aAAD,EAAgB,OAAhB,EAA2B;AAC9B,QAAM,mBAAmB,GAAG,qBAAqB,CAAC,aAAD,EAAgB,UAAC,QAAD;AAAA,aAAc,QAAQ,CAAC,eAAT,EAAd;AAAA,KAAhB,CAAjD;;AAEA,QAAI;AACA;AACA,MAAA,mBAAmB,CAAC,YAApB,GAAmC,CAAnC;AACH,KAHD,CAGE,OAAO,GAAP,EAAY;AACV,aAAO,8BAA8B,CAAC,aAAD,EAAgB,OAAhB,CAArC;AACH;;AAED,IAAA,4BAA4B,CAAC,mBAAD,EAAsB,OAAtB,CAA5B,CAV8B,CAY9B;;AACA,QAAI,OAAO,CAAC,oBAAR,KAAiC,mBAAmB,CAAC,SAAzD,EAAoE;AAChE,MAAA,mBAAmB,CAAC,SAApB,GAAgC,CAAC,OAAO,CAAC,oBAAzC;AACH;;AAED,IAAA,2BAA2B,CAAC,mBAAD,EAAsB,OAAtB,EAA+B,QAA/B,CAA3B,CAjB8B,CAmB9B;;AACA,QAAI,OAAO,CAAC,YAAR,GAAuB,CAA3B,EAA8B;AAC1B,YAAM,uBAAuB,EAA7B;AACH;;AAED,IAAA,kBAAkB,CACd,mBADc,EAEd,cAFc,EAGd,UAAC,GAAD;AAAA,aAAS;AAAA,eAAM,GAAG,CAAC,IAAJ,CAAS,mBAAT,CAAN;AAAA,OAAT;AAAA,KAHc,EAId,UAAC,GAAD;AAAA,aAAS,UAAC,KAAD,EAAU;AACf,YAAI,KAAK,GAAG,CAAZ,EAAe;AACX,gBAAM,uBAAuB,EAA7B;AACH;;AAED,eAAO,GAAG,CAAC,IAAJ,CAAS,mBAAT,EAA8B,KAA9B,CAAP;AACH,OAND;AAAA,KAJc,CAAlB,CAxB8B,CAqC9B;;AACA,QAAI,OAAO,CAAC,gBAAR,KAA6B,KAAjC,EAAwC;AACpC,YAAM,uBAAuB,EAA7B;AACH;;AAED,IAAA,kBAAkB,CACd,mBADc,EAEd,kBAFc,EAGd,UAAC,GAAD;AAAA,aAAS;AAAA,eAAM,GAAG,CAAC,IAAJ,CAAS,mBAAT,CAAN;AAAA,OAAT;AAAA,KAHc,EAId,UAAC,GAAD;AAAA,aAAS,UAAC,KAAD,EAAU;AACf,YAAI,KAAK,KAAK,KAAd,EAAqB;AACjB,gBAAM,uBAAuB,EAA7B;AACH;;AAED,eAAO,GAAG,CAAC,IAAJ,CAAS,mBAAT,EAA8B,KAA9B,CAAP;AACH,OAND;AAAA,KAJc,CAAlB;AAaA,WAAO,mBAAP;AACH,GAxDD;AAyDH,CA/DM","sourceRoot":"","sourcesContent":["import { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeConvolverNodeFactory = (createNativeAudioNode, createNativeConvolverNodeFaker, createNotSupportedError, overwriteAccessors) => {\n    return (nativeContext, options) => {\n        const nativeConvolverNode = createNativeAudioNode(nativeContext, (ntvCntxt) => ntvCntxt.createConvolver());\n        try {\n            // Bug #166: Opera does not allow yet to set the channelCount to 1.\n            nativeConvolverNode.channelCount = 1;\n        }\n        catch (err) {\n            return createNativeConvolverNodeFaker(nativeContext, options);\n        }\n        assignNativeAudioNodeOptions(nativeConvolverNode, options);\n        // The normalize property needs to be set before setting the buffer.\n        if (options.disableNormalization === nativeConvolverNode.normalize) {\n            nativeConvolverNode.normalize = !options.disableNormalization;\n        }\n        assignNativeAudioNodeOption(nativeConvolverNode, options, 'buffer');\n        // Bug #113: Edge & Safari allow to set the channelCount to a value larger than 2.\n        if (options.channelCount > 2) {\n            throw createNotSupportedError();\n        }\n        overwriteAccessors(nativeConvolverNode, 'channelCount', (get) => () => get.call(nativeConvolverNode), (set) => (value) => {\n            if (value > 2) {\n                throw createNotSupportedError();\n            }\n            return set.call(nativeConvolverNode, value);\n        });\n        // Bug #114: Edge & Safari allow to set the channelCountMode to 'max'.\n        if (options.channelCountMode === 'max') {\n            throw createNotSupportedError();\n        }\n        overwriteAccessors(nativeConvolverNode, 'channelCountMode', (get) => () => get.call(nativeConvolverNode), (set) => (value) => {\n            if (value === 'max') {\n                throw createNotSupportedError();\n            }\n            return set.call(nativeConvolverNode, value);\n        });\n        return nativeConvolverNode;\n    };\n};\n//# sourceMappingURL=native-convolver-node-factory.js.map"]},"metadata":{},"sourceType":"module"}