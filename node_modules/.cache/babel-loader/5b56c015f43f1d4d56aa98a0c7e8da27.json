{"ast":null,"code":"import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { wrapAudioScheduledSourceNodeStartMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-start-method-negative-parameters';\nimport { wrapAudioScheduledSourceNodeStopMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-stop-method-negative-parameters';\nexport var createNativeOscillatorNodeFactory = function createNativeOscillatorNodeFactory(addSilentConnection, cacheTestResult, createNativeAudioNode, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls) {\n  return function (nativeContext, options) {\n    var nativeOscillatorNode = createNativeAudioNode(nativeContext, function (ntvCntxt) {\n      return ntvCntxt.createOscillator();\n    });\n    assignNativeAudioNodeOptions(nativeOscillatorNode, options);\n    assignNativeAudioNodeAudioParamValue(nativeOscillatorNode, options, 'detune');\n    assignNativeAudioNodeAudioParamValue(nativeOscillatorNode, options, 'frequency');\n\n    if (options.periodicWave !== undefined) {\n      nativeOscillatorNode.setPeriodicWave(options.periodicWave);\n    } else {\n      assignNativeAudioNodeOption(nativeOscillatorNode, options, 'type');\n    } // Bug #44: Only Chrome & Opera throw a RangeError yet.\n\n\n    if (!cacheTestResult(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, function () {\n      return testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(nativeContext);\n    })) {\n      wrapAudioScheduledSourceNodeStartMethodNegativeParameters(nativeOscillatorNode);\n    } // Bug #19: Safari does not ignore calls to stop() of an already stopped AudioBufferSourceNode.\n\n\n    if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, function () {\n      return testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport(nativeContext);\n    })) {\n      wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls(nativeOscillatorNode, nativeContext);\n    } // Bug #44: Only Firefox does not throw a RangeError yet.\n\n\n    if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, function () {\n      return testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(nativeContext);\n    })) {\n      wrapAudioScheduledSourceNodeStopMethodNegativeParameters(nativeOscillatorNode);\n    } // Bug #175: Safari will not fire an ended event if the OscillatorNode is unconnected.\n\n\n    addSilentConnection(nativeContext, nativeOscillatorNode);\n    return nativeOscillatorNode;\n  };\n};","map":{"version":3,"sources":["../../../src/factories/native-oscillator-node-factory.ts"],"names":[],"mappings":"AAAA,SAAS,oCAAT,QAAqD,uDAArD;AACA,SAAS,2BAAT,QAA4C,4CAA5C;AACA,SAAS,4BAAT,QAA6C,6CAA7C;AACA,SAAS,yDAAT,QAA0E,8EAA1E;AACA,SAAS,wDAAT,QAAyE,6EAAzE;AAGA,OAAO,IAAM,iCAAiC,GAAwC,SAAzE,iCAAyE,CAClF,mBADkF,EAElF,eAFkF,EAGlF,qBAHkF,EAIlF,gEAJkF,EAKlF,6DALkF,EAMlF,+DANkF,EAOlF,sDAPkF,EAQlF;AACA,SAAO,UAAC,aAAD,EAAgB,OAAhB,EAA2B;AAC9B,QAAM,oBAAoB,GAAG,qBAAqB,CAAC,aAAD,EAAgB,UAAC,QAAD;AAAA,aAAc,QAAQ,CAAC,gBAAT,EAAd;AAAA,KAAhB,CAAlD;AAEA,IAAA,4BAA4B,CAAC,oBAAD,EAAuB,OAAvB,CAA5B;AAEA,IAAA,oCAAoC,CAAC,oBAAD,EAAuB,OAAvB,EAAgC,QAAhC,CAApC;AACA,IAAA,oCAAoC,CAAC,oBAAD,EAAuB,OAAvB,EAAgC,WAAhC,CAApC;;AAEA,QAAI,OAAO,CAAC,YAAR,KAAyB,SAA7B,EAAwC;AACpC,MAAA,oBAAoB,CAAC,eAArB,CAAqC,OAAO,CAAC,YAA7C;AACH,KAFD,MAEO;AACH,MAAA,2BAA2B,CAAC,oBAAD,EAAuB,OAAvB,EAAgC,MAAhC,CAA3B;AACH,KAZ6B,CAc9B;;;AACA,QACI,CAAC,eAAe,CAAC,gEAAD,EAAmE;AAAA,aAC/E,gEAAgE,CAAC,aAAD,CADe;AAAA,KAAnE,CADpB,EAIE;AACE,MAAA,yDAAyD,CAAC,oBAAD,CAAzD;AACH,KArB6B,CAuB9B;;;AACA,QACI,CAAC,eAAe,CAAC,6DAAD,EAAgE;AAAA,aAC5E,6DAA6D,CAAC,aAAD,CADe;AAAA,KAAhE,CADpB,EAIE;AACE,MAAA,sDAAsD,CAAC,oBAAD,EAAuB,aAAvB,CAAtD;AACH,KA9B6B,CAgC9B;;;AACA,QACI,CAAC,eAAe,CAAC,+DAAD,EAAkE;AAAA,aAC9E,+DAA+D,CAAC,aAAD,CADe;AAAA,KAAlE,CADpB,EAIE;AACE,MAAA,wDAAwD,CAAC,oBAAD,CAAxD;AACH,KAvC6B,CAyC9B;;;AACA,IAAA,mBAAmB,CAAC,aAAD,EAAgB,oBAAhB,CAAnB;AAEA,WAAO,oBAAP;AACH,GA7CD;AA8CH,CAvDM","sourceRoot":"","sourcesContent":["import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { wrapAudioScheduledSourceNodeStartMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-start-method-negative-parameters';\nimport { wrapAudioScheduledSourceNodeStopMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-stop-method-negative-parameters';\nexport const createNativeOscillatorNodeFactory = (addSilentConnection, cacheTestResult, createNativeAudioNode, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls) => {\n    return (nativeContext, options) => {\n        const nativeOscillatorNode = createNativeAudioNode(nativeContext, (ntvCntxt) => ntvCntxt.createOscillator());\n        assignNativeAudioNodeOptions(nativeOscillatorNode, options);\n        assignNativeAudioNodeAudioParamValue(nativeOscillatorNode, options, 'detune');\n        assignNativeAudioNodeAudioParamValue(nativeOscillatorNode, options, 'frequency');\n        if (options.periodicWave !== undefined) {\n            nativeOscillatorNode.setPeriodicWave(options.periodicWave);\n        }\n        else {\n            assignNativeAudioNodeOption(nativeOscillatorNode, options, 'type');\n        }\n        // Bug #44: Only Chrome & Opera throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStartMethodNegativeParameters(nativeOscillatorNode);\n        }\n        // Bug #19: Safari does not ignore calls to stop() of an already stopped AudioBufferSourceNode.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, () => testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls(nativeOscillatorNode, nativeContext);\n        }\n        // Bug #44: Only Firefox does not throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodNegativeParameters(nativeOscillatorNode);\n        }\n        // Bug #175: Safari will not fire an ended event if the OscillatorNode is unconnected.\n        addSilentConnection(nativeContext, nativeOscillatorNode);\n        return nativeOscillatorNode;\n    };\n};\n//# sourceMappingURL=native-oscillator-node-factory.js.map"]},"metadata":{},"sourceType":"module"}